{
  name: "DIM GROUP 1"


  transformations: {

    ## ############################### START OF CONFIG #################################################################

      dim_epg: {
      source: jdbc
            jdbc: {
              url: "jdbc:oracle:thin:@dwh-scan.azercell.com:1521/dwh.azercell.com"
              user: "dwhprd"
              password: "dw_hwd20prd7"
              options: ["fetchsize:100000"]
            }
      materialize: table
      targetName: "dlkprd.dlk_dim_epg_services"
      mode: overwrite
      format: hive
      sql: """
       select cast(SERVICE_ID as int) SERVICE_ID, SERVICE_NAME from DWHPRD.DWH_DIM_EPG_SERVICES
       """
      dataTests: {
        columns: {
          col1: [notNull, unique]
          col2: [unique]
          col3: [
            unique, 
            {
              acceptedValues: {
                values: ['1', '2', '3', '4']
            }
            }
            ]
        }
        custom: {
          duplicate_check: "SELECT duplicate_check();"
        }
      }
    }

  }
}
